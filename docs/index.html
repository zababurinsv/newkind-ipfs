<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>html2obj</title></head><body> <div class="__main_test"></div> <div class="_main_test"></div> <div class="-main_test"></div> <div class="--main_test"></div> </body><script type="module">let e=Object.prototype.hasOwnProperty,l=Object.prototype.toString;var o=function(o){if(null==o)return!0;if("boolean"==typeof o)return!1;if("number"==typeof o)return 0===o;if("string"==typeof o)return 0===o.length;if("function"==typeof o)return 0===o.length;if(Array.isArray(o)){return o instanceof Object?0===Object.keys(o).length:0===o.length}if(o instanceof Error)return""===o.message;if(o.toString==l)switch(o.toString()){case"[object File]":case"[object Map]":case"[object Set]":return 0===o.size;case"[object Object]":for(var a in o)if(e.call(o,a))return!1;return!0}return!1};function a(e,l){var o={},a=(l=l||{}).short,t=e.split("__"),m=t[0].split("_");if(o.block=m[0],m.length>1&&(o.mod=m[1],m[2]&&(o[a?"val":"modVal"]=m[2])),t.length>1){var s=t[1].split("_");o.elem=s[0],s.length>1&&(o[a?"mod":"elemMod"]=s[1],s[2]&&(o[a?"val":"elemModVal"]=s[2]))}return o}function t(e,l,a,t,m,s,n){for(let r in l)switch(r){case"block":case"elemModVal":break;case"elem":switch(s){case 0:o(e[t[0]])&&(e[t[0]]=[]),a&&(o(e[t[0]].main)&&(e[t[0]].main=[]),e[t[0]].main.push(n));break;case 1:o(e[t[0]])&&(e[t[0]]=[]),o(e[t[0]][t[1]])&&(e[t[0]][t[1]]=[]),a&&(o(e[t[0]][t[1]].main)&&(e[t[0]][t[1]].main=[]),e[t[0]][t[1]].main.push(n));break;case 2:o(e[t[0]])&&(e[t[0]]=[]),o(e[t[0]][t[1]])&&(e[t[0]][t[1]]=[]),o(e[t[0]][t[1]][t[2]])&&(e[t[0]][t[1]][t[2]]=[]),a&&(o(e[t[0]][t[1]][t[2]].main)&&(e[t[0]][t[1]][t[2]].main=[]),e[t[0]][t[1]][t[2]].main.push(n));break;case 3:o(e[t[0]])&&(e[t[0]]=[]),o(e[t[0]][t[1]])&&(e[t[0]][t[1]]=[]),o(e[t[0]][t[1]][t[2]])&&(e[t[0]][t[1]][t[2]]=[]),o(e[t[0]][t[1]][t[2]][t[3]])&&(e[t[0]][t[1]][t[2]][t[3]]=[]),a&&(o(e[t[0]][t[1]][t[2]][t[3]].main)&&(e[t[0]][t[1]][t[2]][t[3]].main=[]),e[t[0]][t[1]][t[2]][t[3]].main.push(n));break;case 4:o(e[t[0]])&&(e[t[0]]=[]),o(e[t[0]][t[1]])&&(e[t[0]][t[1]]=[]),o(e[t[0]][t[1]][t[2]])&&(e[t[0]][t[1]][t[2]]=[]),o(e[t[0]][t[1]][t[2]][t[3]])&&(e[t[0]][t[1]][t[2]][t[3]]=[]),o(e[t[0]][t[1]][t[2]][t[3]][t[4]])&&(e[t[0]][t[1]][t[2]][t[3]][t[4]]=[]),a&&(o(e[t[0]][t[1]][t[2]][t[3]][t[4]].main)&&(e[t[0]][t[1]][t[2]][t[3]][t[4]].main=[]),e[t[0]][t[1]][t[2]][t[3]][t[4]].main.push(n));break;default:console.warn("не хватает ячеек")}break;case"elemMod":switch(s){case 0:o(e[t[0]][`${l.elemMod}`])&&(e[t[0]][`${l.elemMod}`]=[]),m?(o(e[t[0]][`${l.elemMod}`][`${l.elemModVal}`])&&(e[t[0]][`${l.elemMod}`][`${l.elemModVal}`]=[]),e[t[0]][`${l.elemMod}`][`${l.elemModVal}`].push(n)):(o(e[t[0]][`${l.elemMod}`].main)&&(e[t[0]][`${l.elemMod}`].main=[]),e[t[0]][`${l.elemMod}`].main.push(n));break;case 1:o(e[t[0]][t[1]][`${l.elemMod}`])&&(e[t[0]][t[1]][`${l.elemMod}`]=[]),m?(o(e[t[0]][t[1]][`${l.elemMod}`][`${l.elemModVal}`])&&(e[t[0]][t[1]][`${l.elemMod}`][`${l.elemModVal}`]=[]),e[t[0]][t[1]][`${l.elemMod}`][`${l.elemModVal}`].push(n)):(o(e[t[0]][t[1]][`${l.elemMod}`].main)&&(e[t[0]][t[1]][`${l.elemMod}`].main=[]),e[t[0]][t[1]][`${l.elemMod}`].main.push(n));break;case 2:o(e[t[0]][t[1]][t[2]][`${l.elemMod}`])&&(e[t[0]][t[1]][t[2]][`${l.elemMod}`]=[]),m?(o(e[t[0]][t[1]][t[2]][`${l.elemMod}`][`${l.elemModVal}`])&&(e[t[0]][t[1]][t[2]][`${l.elemMod}`][`${l.elemModVal}`]=[]),e[t[0]][t[1]][t[2]][`${l.elemMod}`][`${l.elemModVal}`].push(n)):(o(e[t[0]][t[1]][t[2]][`${l.elemMod}`].main)&&(e[t[0]][t[1]][t[2]][`${l.elemMod}`].main=[]),e[t[0]][t[1]][t[2]][`${l.elemMod}`].main.push(n));break;case 3:o(e[t[0]][t[1]][t[2]][t[3]][`${l.elemMod}`])&&(e[t[0]][t[1]][t[2]][t[3]][`${l.elemMod}`]=[]),m?(o(e[t[0]][t[1]][t[2]][t[3]][`${l.elemMod}`][`${l.elemModVal}`])&&(e[t[0]][t[1]][t[2]][t[3]][`${l.elemMod}`][`${l.elemModVal}`]=[]),e[t[0]][t[1]][t[2]][t[3]][`${l.elemMod}`][`${l.elemModVal}`].push(n)):(o(e[t[0]][t[1]][t[2]][t[3]][`${l.elemMod}`].main)&&(e[t[0]][t[1]][t[2]][t[3]][`${l.elemMod}`].main=[]),e[t[0]][t[1]][t[2]][t[3]][`${l.elemMod}`].main.push(n));break;default:console.log("недостаточно ячеек для обработки")}break;default:console.log("неизвестное свойство",r,{obj:l})}}var m=(e,l,o)=>new Promise((async(m,s)=>{let n={};l.forEach((e=>{let l={};"id"===o.type?l=e.id:"class"===o.type?l=1===e.classList.length?e.className:e.classList:"slot"===o.type?l=e.slot:console.warn("неизвестный тип",o);let m={},s={},r={},i=0,d={};if("object"==typeof l)for(let o of l)m=a(o),s=!("elemMod"in m),r="elemModVal"in m,i=0,d={},"elem"in m&&(d=m.elem.split("-"),i=d.length-1),console.log("aaaaaaaaaa",m),t(n,m,s,d,r,i,e);else m=a(l),s=!("elemMod"in m),r="elemModVal"in m,i=0,d={},"elem"in m&&(d=m.elem.split("-"),i=d.length-1),t(n,m,s,d,r,i,e)})),"id"===o.type?e.id=n:"class"===o.type?e.class=n:"slot"===o.type?e.slot=n:console.warn("неизвестный тип"),n={},m(e)}));((e=!0,l=document.body)=>new Promise((async(a,t)=>{try{let t={obj:{},params:{}};t.params.debug=e;let s=l.querySelectorAll("[id]"),n=l.querySelectorAll("[class]");t.obj=await m(t.obj,s,{type:"id"}),t.obj=await m(t.obj,n,{type:"class"}),a(new Proxy(t.obj,{get:(e,l)=>(t.params.debug&&console.log({_:"proxy get",prop:l,obj:e,value:e[l]}),e[l]),set:(e,l,a)=>(t.params.debug&&console.log({_:"proxy set",prop:l,obj:e,value:a}),o(e[l])&&(e[l]=[]),e[l]=a,!0)}))}catch(e){a({message:e.message,success:!0,status:!0})}})))().then((async e=>{console.log("html",e)}));</script></html>